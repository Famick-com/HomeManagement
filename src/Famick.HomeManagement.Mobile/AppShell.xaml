<?xml version="1.0" encoding="UTF-8" ?>
<Shell
    x:Class="Famick.HomeManagement.Mobile.AppShell"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"
    xmlns:pages="clr-namespace:Famick.HomeManagement.Mobile.Pages"
    FlyoutBehavior="Flyout"
    ios:NavigationPage.IsNavigationBarTranslucent="True">

    <!-- Household name in navigation bar with notification bell -->
    <Shell.TitleView>
        <Grid ColumnDefinitions="*,Auto" Padding="0,0,5,0">
            <Label x:Name="TitleLabel"
                   Grid.Column="0"
                   FontSize="18"
                   FontAttributes="Bold"
                   VerticalOptions="Center"
                   TextColor="{AppThemeBinding Light=Black, Dark=White}" />
            <Grid Grid.Column="1" WidthRequest="24" HeightRequest="24">
                <ImageButton x:Name="NotificationBellButton"
                             Clicked="OnNotificationBellClicked"
                             Source="notification_bell"
                             Aspect="AspectFit"
                             WidthRequest="16"
                             HeightRequest="16"
                             HorizontalOptions="Center"
                             VerticalOptions="Center"
                             BackgroundColor="Transparent" />
                <Border x:Name="NotificationBadge"
                        IsVisible="False"
                        WidthRequest="14"
                        HeightRequest="14"
                        StrokeShape="RoundRectangle 7"
                        Stroke="Transparent"
                        BackgroundColor="#E53935"
                        HorizontalOptions="End"
                        VerticalOptions="Start"
                        Margin="0,0,0,0">
                    <Label x:Name="NotificationBadgeLabel"
                           Text="0"
                           FontSize="8"
                           TextColor="White"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />
                </Border>
            </Grid>
        </Grid>
    </Shell.TitleView>

    <Shell.Resources>
        <ResourceDictionary>
            <Style TargetType="Shell" ApplyToDerivedTypes="True">
                <!-- IMPORTANT: Removing explicit background allows iOS 26 Liquid Glass -->
                <Setter Property="Shell.BackgroundColor" Value="Transparent" />
                <Setter Property="Shell.ForegroundColor" Value="{AppThemeBinding Light=Black, Dark=White}" />
                <Setter Property="Shell.TitleColor" Value="{AppThemeBinding Light=Black, Dark=White}" />
            </Style>
        </ResourceDictionary>
    </Shell.Resources>

    <!-- Flyout Header: Famick Logo with Household Name -->
    <Shell.FlyoutHeader>
        <Grid HeightRequest="140" BackgroundColor="#E0DBF0C9" Padding="15">
            <VerticalStackLayout VerticalOptions="Center" Spacing="5">
                <Image Source="famick_logo"
                       Aspect="AspectFit"
                       HorizontalOptions="Center"
                       HeightRequest="70" />
                <Label x:Name="HouseholdNameLabel"
                       Text=""
                       FontSize="14"
                       HorizontalOptions="Center"
                       TextColor="{AppThemeBinding Light=#424242, Dark=#E0E0E0}" />
            </VerticalStackLayout>
        </Grid>
    </Shell.FlyoutHeader>

    <!-- Main Content -->
    <FlyoutItem Title="Dashboard">
        <ShellContent
            Title="Dashboard"
            ContentTemplate="{DataTemplate pages:DashboardPage}"
            Route="DashboardPage" />
    </FlyoutItem>

    <FlyoutItem Title="Shopping Lists">
        <ShellContent
            Title="Shopping Lists"
            ContentTemplate="{DataTemplate pages:ListSelectionPage}"
            Route="ListSelectionPage" />
    </FlyoutItem>

    <FlyoutItem Title="Take Inventory">
        <ShellContent
            Title="Take Inventory"
            ContentTemplate="{DataTemplate pages:InventorySessionPage}"
            Route="InventorySessionPage" />
    </FlyoutItem>

    <FlyoutItem Title="Stock Overview">
        <ShellContent
            Title="Stock Overview"
            ContentTemplate="{DataTemplate pages:StockOverviewPage}"
            Route="StockOverviewPage" />
    </FlyoutItem>

    <!-- Menu Footer with Actions -->
    <Shell.FlyoutFooter>
        <VerticalStackLayout Padding="15" Spacing="8">
            <!-- Coming Soon Note -->
            <Label Text="More features coming soon!"
                   FontSize="12"
                   TextColor="{AppThemeBinding Light=#757575, Dark=#9E9E9E}"
                   HorizontalOptions="Center"
                   Margin="0,0,0,10" />

            <BoxView HeightRequest="1"
                     BackgroundColor="{AppThemeBinding Light=#E0E0E0, Dark=#424242}"
                     Margin="0,0,0,5" />

            <Button Text="Settings"
                    Clicked="OnSettingsClicked"
                    BackgroundColor="Transparent"
                    TextColor="{AppThemeBinding Light=Black, Dark=White}"
                    HorizontalOptions="Start"
                    Padding="0" />
            <Button Text="Sign Out"
                    Clicked="OnSignOutClicked"
                    BackgroundColor="Transparent"
                    TextColor="{AppThemeBinding Light=#D32F2F, Dark=#EF5350}"
                    HorizontalOptions="Start"
                    Padding="0" />
        </VerticalStackLayout>
    </Shell.FlyoutFooter>

</Shell>
